<script type="text/javascript" src="https://app.getresponse.com/view_webform_v2.js?u=yMub9&webforms_id=S7vtD" data-webform-id="S7vtD"></script>

<style>
  /* Set the size of the div element that contains the map */
  #map {
    height: 400px; /* The height is 400 pixels */
    width: 100%; /* The width is the width of the web page */
  }
</style>

<input type="hidden" id="currentshopname" value="@ViewBag.ShopName" />


<!--GEOCODING-->
<script defer
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAgozqaauyOduNZOhJnLIdEkN4flw4bHDk&callback=initMap">
</script>


<script>
  "use strict";
  var shopname = document.getElementById("currentshopname").value;
  function initMap() {
    const map = new google.maps.Map(document.getElementById("map"), {
      //zoom: 8,
      zoom: 8,
      center: {
        lat: 9.0820,
        lng: 8.6753
      }
    });
    const geocoder = new google.maps.Geocoder();
    const infowindow = new google.maps.InfoWindow();
    geocodeAddress(geocoder, map, infowindow);
  }
  function geocodeAddress(geocoder, map, infowindow) {
    const address = document.getElementById("address").value;
    geocoder.geocode(
      {
        address: address
      },
      (results, status) => {
        if (status === "OK") {
          map.setCenter(results[0].geometry.location);
          const marker = new google.maps.Marker({
            map: map,
            position: results[0].geometry.location,
          });
          infowindow.setContent(shopname + " - " + results[0].formatted_address);
          infowindow.open(map, marker);
        } else {
          alert(
            "Location Not Found: " + status
          );
        }
      }
    );
  }
</script>
<!-- END GEOCODING-->

@model IEnumerable<Myvshoponline.Product>
@using Myvshoponline.Controllers;
@{ MyvshoponlineEntities db = new MyvshoponlineEntities();
  Getdata mydata = new Getdata();
  int CommissionPercent = Convert.ToInt32(db.Settings.Select(s => s.CommissionPercent).FirstOrDefault());
  decimal c_percent = (decimal)(CommissionPercent / 100.00);
}
@{
  ViewBag.Title = ViewBag.ShopName;
}
@{
  int UserID = ViewBag.UserID;
  int paymentstatus = (int)db.Users.Where(p => p.ID == UserID).Select(p => p.PaymentStatus).FirstOrDefault();

  int lYear = (int)db.Users.Where(k => k.ID == UserID).Select(k => k.LaunchYear).FirstOrDefault();
  int lmonth = (int)db.Users.Where(k => k.ID == UserID).Select(k => k.LaunchMonth).FirstOrDefault();
  int lday = (int)db.Users.Where(k => k.ID == UserID).Select(k => k.LaunchDay).FirstOrDefault();

  int pYear = (int)db.Users.Where(k => k.ID == UserID).Select(k => k.PreviousYear).FirstOrDefault();
  int pmonth = (int)db.Users.Where(k => k.ID == UserID).Select(k => k.PreviousMonth).FirstOrDefault();
  int pday = (int)db.Users.Where(k => k.ID == UserID).Select(k => k.PreviousDay).FirstOrDefault();

  DateTime lauchd = new DateTime(lYear, lmonth, lday);
  DateTime prevd = new DateTime(pYear, pmonth, pday);
  TimeSpan diff = lauchd.Subtract(prevd);
  ViewBag.diff = diff.Days;
  ViewBag.FixedDays = db.Users.Find(UserID).FixedDays;
  ViewBag.Ndays = db.Users.Find(UserID).NDays;

  //if (ViewBag.diff > ViewBag.FixedDays)
  //{
  //    ViewBag.Expired = "Your plan has expired!";
  //    mydata.Update_ShopStatus_to_Inactive_on_Expiry(UserID);
  //}
  //else
  //{
  //    var r = db.Set<User>().Find(UserID);
  //    r.NDays = ViewBag.diff;
  //    r.LaunchDate = DateTime.Now;
  //    r.LaunchYear = DateTime.Now.Year;
  //    r.LaunchMonth = DateTime.Now.Month;
  //    r.LaunchDay = DateTime.Now.Day;
  //    db.SaveChanges();
  //}

}

<body>

  @foreach (var item in ViewBag.ProductsDetail)
  {

    <!-- Modal Upload Product Image-->
    <div class="modal" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
      <div class="modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" style="font-size:14px">Upload Product Picture for @item.Name</h5>
            <button type="button" class="close" data-dismiss="modal">X</button>
          </div>
          <div class="modal-body">
            @using (Html.BeginForm("UploadProductPicture", "Products", FormMethod.Post, new { enctype = "multipart/form-data" }))
            {
              <input type="hidden" value="@item.ID" name="ProductID" />
              <input type="hidden" value="@item.ShopID" name="ShopID" />
              <input type="hidden" value="@item.ProductCategoryID" name="ProductCategoryID" />
              <input type="hidden" value="@Session["UserID"]" name="UserID" />
              <font color="black">
                <input type="file" name="files" id="uploadFile" style="width: 100%;" class="btn btn-default" />
              </font><hr />
              <input type="submit" class="btn btn-common" value="Upload" onclick="return CheckFileName();">
            }
          </div>
        </div>

      </div>
    </div>

    {
      var passports = item.ID + ".jpg";

      <div class="modal" id="myModal1" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="width:300px !important;">
        <div class="modal-dialog-centered">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" style="font-size:12px">@item.Name</h5>
              <button type="button" class="close" data-dismiss="modal">X</button>
            </div>
            <div class="modal-body">
              <center>
                <img src="~/BusinessImages/@item.Shop.User.CompanyName@item.Shop.User.HardToken/@item.Shop.Name/@passports" style="width:100%" />
              </center>
            </div>
          </div>
        </div>
      </div>
    }
  }

  <div id="fb-root"></div>
  <script async defer crossorigin="anonymous" src="https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v4.0&appId=431464983901995&autoLogAppEvents=1"></script>
  <div id="content" style="margin-top:-32px">
    <div class="panel">
      <div class="panel-heading" style="background-color:#17A2B8;border-top-right-radius:20px;border-top-left-radius:20px; ">
        <h1 class="panel-title" style="color:white;font-family:'Gill Sans MT';text-align:center;font-size:14px">@ViewBag.ShopName </h1>
        @foreach (var item22 in ViewBag.ProductsDetail)
        {
          <h1 class="panel-title" style="color:white;font-family:'Times New Roman';text-align:center;font-size:8px;">
            <i class="lni-map-marker"></i> @item22.Shop.Address
          </h1>
        }
      </div>
      @*<div class="panel-body">
        </div>*@
    </div>


    <div class="row">
      <div class="col-lg-8 col-md-12 col-xs-12">
        <h6 style="font-size:12px">
          @*<a href="~/Users/BusinessLanding/@ViewBag.UserID"><i class="lni-user"></i> @ViewBag.CompanyName </a> &raquo;<a href="~/Shops/ShopDetails/@ViewBag.ShopID"> @ViewBag.ShopName</a> &raquo; <b style="color:black"><a href="~/Products/ProductCategoryDetails/?id=@ViewBag.CategoryID&sid=@ViewBag.ShopID">@ViewBag.CategoryName</a></b> &raquo; <b style="color:black">@ViewBag.ProductName</b>*@
          &raquo; <b style="color:black">  <a href="~/Shops/ShopDetails"> @ViewBag.ShopName</a> <a href="~/Products/ProductCategoryDetails" onclick="setObjectSession('ProductCategoryID',@ViewBag.CategoryID)">&raquo; @ViewBag.CategoryName</a></b> @*&raquo; <b style="color:black">@ViewBag.ProductName</b>*@
        </h6>
      </div>
      <div class="col-lg-4 col-md-12 col-xs-12">
        <!-- Search Widget -->
        <div class="widget">
          @{
            int categoryid = db.ProductCategories.Where(c => c.Name == "All Categories").Select(c => c.ID).FirstOrDefault();
            int locationid = db.States.Where(c => c.Name == "All Locations").Select(c => c.ID).FirstOrDefault();
          }
          @*<form action="~/Home/search" method="get">
            <div class="input-group">
                <input type="text" class="form-control" name="search" placeholder="Search for products">
                <input type="hidden" name="LocationID" value="@locationid" />
                <input type="hidden" name="ProductCategoryID" value="@categoryid" />
                <div class="input-group-append">
                    <button class="btn btn-primary" type="submit" style="width:20px">
                        <i class="lni-search"></i>
                    </button>
                </div>
            </div>
            </form>*@
        </div>
      </div>
    </div>


    <!-- Listings Section Start -->
    <h3 style="background-color:#F2F4F6;font-family:'Bookman Old Style';font-size:12px;padding:10px;">
      @ViewBag.ProductName
      @if (!string.IsNullOrEmpty((string)Session["username"]) && ((string)Session["UserRole"] == "Shop Admin" || (string)Session["UserRole"] == "Super Admin") && (int)Session["UserID"] == (int)ViewBag.UserID)
      {
        foreach (var item1 in ViewBag.ProductsDetail)
        {
          @*<span class="full-time" style="color:white; background-color:white;padding:0px;margin:0px;">
                <a href="#" class="btn btn-primary" style="height:25px;padding:2px;width:35px;font-weight:bold;font-size:17px" title="Change Product Picture" data-toggle="modal" data-target="#myModal" onclick="clearTextBox();"> <i class="lni-camera"></i></a>
            </span>*@

          <a href="~/ProductSubProducts/Create?pid=@item1.ID " class="alerts-title" style="height:25px;padding:2px;font-size:15px" title="Add Sub-items for  @ViewBag.ProductName"> Add Sub-items <i class="lni lni-add-files"></i></a>

        }
      }
    </h3>


    <div class="row">
      <!-- Start Blog Posts -->
      <div class="col-lg-6 col-md-12 col-xs-12">
        <!-- Start Post -->
        @*<div class="blog-post" style="background-color:white;height:235px;">*@
        <div style="background-color:white;">
          <!-- Post Content -->
          @*<div class="post-content">*@
          <div>
            <!-- Category Section Start -->

            @foreach (var item in ViewBag.ProductsDetail)
            {



              {
                var passports = item.ID + ".jpg";
                <center>
                  <img src="~/BusinessImages/@item.Shop.User.CompanyName@item.Shop.User.HardToken/@item.Shop.Name/@passports" title="Click to enlarge" style="width:50%;cursor:pointer;" data-toggle="modal" data-target="#myModal1" onclick="clearTextBox();" />
                  <br /><br />
                  <div id="desktoprating">
                    <img src="~/Images/star.png" style="width:20px;height:20px;" />
                    <img src="~/Images/star.png" style="width:20px;height:20px;" />
                    <img src="~/Images/star.png" style="width:20px;height:20px;" />
                    <img src="~/Images/star.png" style="width:20px;height:20px;" />
                    <img src="~/Images/star empty.png" style="width:25px;height:25px;" />
                  </div>
                </center>

              }
            }



            @foreach (var item in ViewBag.ProductsDetail)
            {
              <p style="color:black">

                @*@item.Details*@
              </p>
            }

            <div class="share-social">

              <div class="social-link">
                @if (!string.IsNullOrEmpty((string)Session["username"]) && ((string)Session["UserRole"] == "Shop Admin" || (string)Session["UserRole"] == "Super Admin") && (int)Session["UserID"] == (int)ViewBag.UserID)
                {
                  foreach (var item1 in ViewBag.ProductsDetail)
                  {
                    int Pid = item1.ID;
                    int ProductViews = db.ProductVisits.Where(p => p.ProductID == Pid).Count();
                    <center>
                      <h4 style="background-color:#33B27B;color:white;font-size:16px;width:50%;font-family:Courier New, Courier, monospace;padding:3px;border-radius:10px;">
                        &nbsp;  No of views <b class="badge badge-secondary"> @ProductViews</b>
                      </h4>
                    </center>

                  }
                }
                @*<span>Share This Product:</span>
                  @foreach (var item in ViewBag.ProductsDetail)
                  {
                      <div class="fb-share-button" data-href="http://marketsquare247.com/Products/ProductDetails/@item.ID?sid=@item.ShopID" data-layout="button" data-size="small">
                          <a target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fdevelopers.facebook.com%2Fdocs%2Fplugins%2F&amp;src=sdkpreparse" class="fb-xfbml-parse-ignore">
                              Share
                          </a>
                      </div>
                  }*@
                <div class="sharethis-inline-share-buttons"></div>

                @*<a class="MagNews" target="_blank" data-original-title="twitter" href="#" data-toggle="tooltip" data-placement="top"><i class="lni-twitter-filled"></i></a>
                  <a class="facebook" target="_blank" data-original-title="facebook" href="#" data-toggle="tooltip" data-placement="top"><i class="lni-facebook-filled"></i></a>
                  <a class="google" target="_blank" data-original-title="google-plus" href="#" data-toggle="tooltip" data-placement="top"><i class="lni-google-plus"></i></a>
                  <a class="linkedin" target="_blank" data-original-title="linkedin" href="#" data-toggle="tooltip" data-placement="top"><i class="lni-linkedin-fill"></i></a>*@
              </div>
            </div>
          </div>
          <!-- Post Content -->
        </div>
        <!-- End Post -->
        <!--on Mobile product category-->

        <aside id="sidebar" style="margin-top:0px;">
          <div id="mobileproductdetails" style="display:none"></div>
        </aside>


        <aside id="sidebar">
          <div id="getcategorycontent" style="display:none"></div>
        </aside>
        <!--End mobile category-->
        <!--on Mobile Similar products-->
        <aside id="sidebar">
          <div id="similarmobile"></div>
          <div id="relatedmobile"></div>
        </aside>
        <!--End mobile similar-->
        <!-- Start Comment Area -->
        <div id="comments">
          <div class="contact-icon">

            <script>
              (function (d, s, id) {
                var js, fjs = d.getElementsByTagName(s)[0];
                if (d.getElementById(id)) return;
                js = d.createElement(s); js.id = id;
                js.src = "https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v3.0";
                fjs.parentNode.insertBefore(js, fjs);
              }(document, 'script', 'facebook-jssdk'));</script>

            <!-- Your share button code -->
            @foreach (var item in ViewBag.ProductsDetail)
            {

              <ul class="mt-4 footer-social">
                <li>Share This Product</li>
                <li>
                  @{
                    string referallink1 = "https://xamagos.com/" + item.Shop.ShopURL + "/?q=" + item.ID;
                  }
                  <div class="fb-share-button"
                       data-href="@referallink1"
                       data-layout="button_count">
                  </div>
                </li>
                <li><a class="twitter" href="http://twitter.com/share?url=@referallink1" title="share on twitter" target="_blank"><i class="lni-twitter-filled"></i></a></li>
                @*<li><a href=http://www.linkedin.com/shareArticle target="_blank"><i class="lni-linkedin"></i></a></li>
                  <li><a class="google-plus" href="#" target="_blank"><i class="lni-google-plus"></i></a></li>*@
                <li>
                  <button href="https://api.whatsapp.com/send?text=@referallink1" data-action="share/whatsapp/share" target="_blank">
                    <img src="~/Images/whatsapp.jfif" style="width:50px;height:50px;">
                  </button>
                </li>

              </ul>
            }
          </div>
          <hr />

          @*<h3>There are @ViewBag.CommentsTotal comments on this product</h3>*@
          <h3>Customer Reviews (@ViewBag.CommentsTotal)</h3>

          @*@foreach (var item in ViewBag.Comments)
            {
                //if (item.Name == "Admin")
                //{
            <div id="comment">
                <b style="color:#00B058;">  @item.Name <font color="black"> <span class="badge badge-info">Administrator</span>  </font></b><br />
                <p id="commentDetails"> @item.Comment</p>

                <b style="color:#FFAA1C;"> @item.Date</b>
            </div>
            }*@
          <ol class="comments-list">
            @foreach (var item in ViewBag.Comments)
            {
              <li style="padding:0px">
                <div class="media">
                  <div class="thumb-left">
                    <img src="~/Images/postimage.jpg" style="width:50px;border-radius:100px;border-color:blue" />
                  </div>
                  <div class="info-body" style="width:100%">
                    <h4 class="name">
                      <b style="color:#000000;">  @item.Name </b>
                      @if (item.PostedBy == "Shop Admin")
                      {
                        <span class="badge badge-info">Administrator</span>
                      }
                    </h4>
                    <p>@item.Comment</p>
                    <span class="comment-date" style="font-weight:bold;color:#dc5c5c">@item.Date</span>
                    @*<a href="#" class="reply-link">Reply</a>*@
                  </div>
                </div>
              </li>
            }
          </ol>





          <!-- Start Respond Form -->
          <div id="respond">
            <h2 class="respond-title">Add a review</h2>
            @foreach (var item in ViewBag.ProductsDetail)
            {
          <form action="~/ProductComments/Create" method="post">
            @Html.AntiForgeryToken()
            <input type="hidden" name="id" value="@item.ID" />
            <input type="hidden" name="shopid" value="@item.ShopID" />
            <div class="row">
              <div class="col-md-6">
                <div class="form-group">
                  <input id="author" class="form-control" name="Name" required="required" type="text" value="" size="30" placeholder="Enter your name">
                </div>
              </div>
              <div class="col-md-6">
                <div class="form-group">
                  <input id="email" class="form-control" name="Email" type="text" value="" size="30" placeholder="Enter your email">
                </div>
              </div>
              <div class="col-md-12">
                <div class="form-group">
                  <input id="subject" class="form-control" name="Subject" type="text" value="" size="30" placeholder="Subject (optional)">
                </div>
              </div>
            </div>
            <div class="row">
              <div class="col-md-12">
                <div class="form-group">
                  <textarea id="comment" class="form-control" required="required" name="comment" cols="45" rows="8" placeholder="Here goes your comment"></textarea>
                </div>
                <button type="submit" id="submit" class="btn btn-common">Submit</button>
              </div>
            </div>
          </form>
            }
          </div>
          <!-- End Respond Form -->
        </div>
        <!-- End Comment Area -->
      </div>
      <!-- End Blog Posts -->
      <!--Sidebar-->
      <aside id="sidebar" class="col-lg-6 col-md-12 col-xs-12" style="margin-top:0px;">
        <!-- Search Widget -->
        <div id="originalproductdetails" style="display:block">
          <div class="widget">
            <div class="right-sideabr" style="padding:0px;margin:5px">

              @foreach (var item in ViewBag.ProductsDetail)
              {

                <hr style="margin:0px;padding:0px" />

                <span class="meta-part" style="padding-left:10px;margin-bottom:0px">
                  <a href="#" style="color:black;font-weight:bold;font-size:24px;font-family:Arial">
                    @if (item.Currency == "NGN")
                    {<span>&#x20A6;</span>}
                    else
                    {

                      <span>@item.Currency</span>}@{

                      @*var a = string.Format("{0:#,0}", item.Amount);}@a*@
                      decimal totalCommission = item.Amount * c_percent;
                      decimal Total = item.Amount;
                      var a = string.Format("{0:#,0}", Total);}@a

                      @*<del style="color:black;opacity:0.5">@{double deal =Math.Round(0.4 * Convert.ToDouble(item.Amount)); double ad = deal + Convert.ToDouble(item.Amount);}<span>â‚¦</span>@{var aad = string.Format("{0:#,0}", ad);}@aad</del>*@
                    </a>
                  </span>
                  if (!string.IsNullOrEmpty((string)Session["username"]) && ((string)Session["UserRole"] == "Shop Admin" || (string)Session["UserRole"] == "Super Admin") && (int)Session["UserID"] == (int)ViewBag.UserID)
                  {
                    <span class="badge-info" title="Quantity" style="font-size:12px;padding:3px;border-radius:4px">@item.QuantityinStock in stock</span>
                  }
                  @*<div id="shipping" style="color:black;background-color:#ffffff">+ shipping</div>*@
                  <div>

                    @if (item.Negotiable == "Yes")
                    {
                      <span class="badge badge-info">Negotiable</span>
                      <script>
                                                        function quantity_negotiate_Loggedin()
                                                        {
                                                          var qty = document.getElementById("quantity") ? document.getElementById("quantity").value : null;
                                                          var ammt = document.getElementById("amount") ? document.getElementById("amount").value : null;
                                                          var dcity = document.getElementById("city") ? document.getElementById("city").value : null;
                                                          var stateid = document.getElementById("StateID") ? document.getElementById("StateID").value : null;
                                                          var shopid = document.getElementById("shopid").value;
                                                          var productid = document.getElementById("productid").value;
                                                            if (stateid == null || stateid == '') {
                                                                //alert('Please choose delivery location');
                                                                document.getElementById("chooselocation").innerHTML = "<div class='alert alert-danger' style='padding-top:2px;padding-bottom:2px;'>Please choose location</div>";
                                                                document.getElementById("StateID").style.borderColor = "red";
                                                                document.getElementById("StateID").focus();
                                                                return false;
                                                            }
                                                            else if (dcity == null || dcity == '') {
                                                                // alert('Please choose city');
                                                                document.getElementById("chooselocation").innerHTML = "<div class='alert alert-danger' style='padding-top:2px;padding-bottom:2px;'>Please choose city</div>";
                                                                document.getElementById("city").style.borderColor = "red";
                                                                document.getElementById("city").focus();
                                                                return false;
                                                            }
                                                            else {
                                                              var negotiate = "Yes";
                                                              setCartSession(productid, shopid, dcity, qty, negotiate);
                                                              handleButtonClick();
                                                              window.location = "../../Products/AddtoCart";                                                              return true;
                                                            }
                                                        }
                                                            function quantity_negotiate_NotLoggedin()
                                                            {
                                                              var qty = document.getElementById("quantity") ? document.getElementById("quantity").value : null;
                                                              var ammt = document.getElementById("amount") ? document.getElementById("amount").value : null;
                                                              var dcity = document.getElementById("city") ? document.getElementById("city").value : null;
                                                              var stateid = document.getElementById("StateID") ? document.getElementById("StateID").value : null;
                                                              var shopid = document.getElementById("shopid").value;
                                                              var productid = document.getElementById("productid").value;
                                                              if (stateid == '' || stateid == null) {
                                                                //alert('Please choose delivery location');
                                                                document.getElementById("chooselocation").innerHTML = "<div class='alert alert-danger' style='padding-top:2px;padding-bottom:2px;'>Please choose location</div>";
                                                                document.getElementById("StateID").style.borderColor = "red";
                                                                document.getElementById("StateID").focus();
                                                                return false;
                                                              }
                                                               else if (dcity == null || dcity == '') {
                                                                    document.getElementById("chooselocation").innerHTML = "<div class='alert alert-danger' style='padding-top:2px;padding-bottom:2px;'>Please choose city</div>";
                                                                    document.getElementById("city").style.borderColor = "red";
                                                                    document.getElementById("city").focus();
                                                                    return false;
                                                                }
                                                              else {
                                                                
                                                                var negotiate = "Yes";
                                                                
                                                                setCartSession(productid, shopid, dcity, qty, negotiate);
                                                                handleButtonClick();
                                                                window.location = "../../Account/Login";
                                                                return true;
                                                                }
                                                            }

                      </script>

                      if (Session["UserID"] != null)
                      {
                        <button class="btn btn-danger" onclick="return quantity_negotiate_Loggedin()" style="background-color:#3CCBF4; 
                            padding-bottom:2px;padding-top:2px;margin:0px;height:25px;font-size:11px;margin-bottom:2px;">
                            <i class="fa fas fa-adjust"></i> Click here to Negotiate</button>

                      }
                      else
                      {
                        <button class="btn btn-danger" onclick="return quantity_negotiate_NotLoggedin()" style="background-color: #3CCBF4; 
                          padding-bottom: 2px; padding-top: 2px; margin: 0px; height: 25px; font-size: 11px; margin-bottom: 2px;">
                          <i class="fa fas fa-adjust"></i>Click here to Negotiate</button>
                      }
                    }
                    else
                    {
                      @*<span class="badge badge-danger">Non-negotiable</span>*@
                    }
                  </div>
                  <div id="totalprice" style="font-weight:bold"></div>
                  <hr style="margin:0px;padding:5px" />

                  int ShopID = item.ShopID;
                  var DeliveryLocations = db.DeliveryLocations.Where(s => s.ShopID == ShopID).ToList();
                  if (db.Shops.Where(s => s.ID == ShopID).Select(s => s.EnableOnlineOrder).FirstOrDefault() == "Yes")
                  {
                    @*<h5 style="color:black;font-size:12px;border:1px solid red;padding:6px;font-family:Arial;">
                          Delivery Locations
                          @foreach (var location in DeliveryLocations)
                          {
                          <span>|</span> @location.State.Name  ;
                                  }
                      </h5>*@
                    @*<div id="deliverynote" style="color:black;"></div>*@
                    @*<form method="get" action="~/ShopCustomers/Create">*@
                      <input type="hidden" id="FromStateID" value="@item.Shop.StateID" />
                      <input type="hidden" id="dcity" name="dcity" />
                      <div class="form-group">
                        <div class="col-md-10">
                          <h5 style="font-size:15px;">YOUR LOCATION</h5>
                          <p style="margin:0px;color:black;" id="chooselocation">  Choose your location</p>
                          @Html.DropDownList("StateID", null, "-- Please Select --", htmlAttributes: new { @class = "form-control", onchange = "GetCities(this.value)", @id = "StateID", @required="required" })
                          <div id="displaycities"></div>
                        </div>
                      </div>

                      <div class="row" style="padding-left:10px;">
                        <b style="color:black;padding:10px;padding-top:7px;vertical-align:central"> Quantity &nbsp; </b>
                        <button type="button" name="decrement" style="cursor:pointer; padding-left:9px;width:40px;height:35px;vertical-align:central; border:solid 1px grey;background-color:white;color:black;font-size:20px;" onclick="decreament()">&minus;</button>
                        <input type="number" min="1" id="quantity" readonly value="1" name="quantity" style="width:40px;height:35px;vertical-align:central;text-align:center;font-weight:bold;font-size:14px" />
                        @*<input type="hidden" value="@item.Amount" name="amount" id="Amount" />*@
                        <input type="hidden" value="@Total" name="amount" id="Amount" />
                        <input type="hidden" id="quantityinstock" value="@item.QuantityinStock" />
                        <input type="hidden" value="@item.ShopID" name="id" id="shopid" />
                        <input type="hidden" value="@item.ID" name="pid" id="productid" />
                        <input type="hidden" value="1" name="v" />
                        <script>

                          function check_location() {
                            var qty = document.getElementById("quantity") ? document.getElementById("quantity").value : null;
                            var ammt = document.getElementById("amount") ? document.getElementById("amount").value : null;
                            var dcity = document.getElementById("city") ? document.getElementById("city").value : null;
                            var stateid = document.getElementById("StateID") ? document.getElementById("StateID").value : null;

                            var shopid = document.getElementById("shopid").value;
                            var productid = document.getElementById("productid").value;
                            if (stateid == null || stateid == '') {
                              document.getElementById("chooselocation").innerHTML = "<div class='alert alert-danger' style='padding-top:2px;padding-bottom:2px;'>Please choose location</div>";
                              document.getElementById("StateID").style.borderColor = "red";
                              document.getElementById("StateID").focus();
                              return false;
                            }
                            else if (dcity == null || dcity == '') {
                              document.getElementById("chooselocation").innerHTML = "<div class='alert alert-danger' style='padding-top:2px;padding-bottom:2px;'>Please choose location</div>";
                              document.getElementById("city").style.borderColor = "red";
                              document.getElementById("city").focus();
                              return false;
                            }
                            else {
                              var negotiate = "No";
                              //Set paramete sessions, redirect to users/create
                              setCartSession(productid, shopid, dcity, qty, negotiate);
                              //show procession dialog
                              handleButtonClick();
                              window.location.href = '../../Account/Login';
                              return false;
                            }
                          }
                        </script>
                        <script>
                                                       function quantity()
                                                        {
                                                         var qty = document.getElementById("quantity") ? document.getElementById("quantity").value : null;
                                                         var ammt = document.getElementById("amount") ? document.getElementById("amount").value : null;
                                                         var dcity = document.getElementById("city") ? document.getElementById("city").value : null;
                                                         var stateid = document.getElementById("StateID") ? document.getElementById("StateID").value : null;

                                                         var shopid = document.getElementById("shopid").value;
                                                         var productid = document.getElementById("productid").value;
                                                         
                                                            if (stateid == null || stateid=='') {
                                                                //alert('Please choose delivery location');
                                                                document.getElementById("chooselocation").innerHTML = "<div class='alert alert-danger' style='padding-top:2px;padding-bottom:2px;'>Please choose location</div>";
                                                                document.getElementById("StateID").style.borderColor = "red";
                                                                document.getElementById("StateID").focus();
                                                                return false;
                                                            }
                                                            else if (dcity == null || dcity == '')
                                                            {
                                                                //alert('Please choose city');
                                                                document.getElementById("chooselocation").innerHTML = "<div class='alert alert-danger' style='padding-top:2px;padding-bottom:2px;'>Please choose location</div>";
                                                                document.getElementById("city").style.borderColor = "red";
                                                                document.getElementById("city").focus();
                                                                return false;
                                                            }
                                                            else {
                                                              var negotiate = "No";
                                                              @*alert('qty=' + q + 'dcity' + dcity + 'sid=' + @item.ShopID+ 'pid' + @item.ID);*@
                                                              setCartSession(productid, shopid, dcity, qty, negotiate);
                                                              //show procession dialog
                                                              handleButtonClick();
                                                              window.location.href = '../../Products/AddtoCart';
                                                             // window.location = "../AddtoCart?pid=" + @item.ID +"&sid=" +@item.ShopID +"&qty=" + q + "&dcity=" + dcity;
                                                            }
                                                        }

                        </script>

                        <input type="hidden" id="quantityinstock" value="@item.QuantityinStock" />

                        <button type="button" style="width:20px;padding-left:8px;width:40px; border:solid 1px grey;height:35px;
                          vertical-align:central;background-color:white;color:black;cursor:pointer;font-size:20px;" name="increment" onclick="increament()">
                          +
                        </button>
                        &nbsp;&nbsp;&nbsp;
                        @if (Session["UserID"] != null)
                        {

                          <a   href="" id="btnCart" class="btn btn-success" onclick="return quantity()" style="background-color:#33B27B;padding-bottom:2px;padding-top:5px;
                              margin:0px;height:35px;margin-left:30px;vertical-align:central"><i class="fa fas fa-cart-plus"></i> Add To Cart</a>
                          @*<a class="btn btn-success" onclick='javascript:window.location="../OrderDetailsCheckOut?pid=@item.ID&sid=@item.ShopID&qty="' style="background-color:#33B27B;padding-bottom:2px;padding-top:5px;margin:0px;height:35px;vertical-align:central">Checkout</a>*@

                        }
                        else
                        {

                          <a href="" id="btnCart" class="btn btn-success" onclick="return check_location()" style="background-color:#33B27B;padding-bottom:2px;padding-top:5px;
                            margin:0px;vertical-align:central;height:35px; margin-left:30px;">
                            <i class="fa fas fa-cart-plus"></i> Add To Cart
                          </a>

                        }
                      </div>
                    @*</form>*@
                    <hr style="padding:2px" />
                  }


                }
              @foreach (var item in ViewBag.ProductsDetail)
              {
                <p style="color:black;padding:10px">
                  <span style="color:black;font-weight:bold">Product Description</span>
                </p>
                <p style="color:black;text-align:justify">  @Html.Raw(HttpUtility.HtmlDecode(item.Details))</p>


                <hr style="margin:0px;padding:0px" />

              }

              <ul class="list-item" style="font-size:10px;padding:0px;margin:0px">
                @if (ViewBag.ShopName != null)
                {
                  foreach (var item in ViewBag.Shop)
                  {
                    int StateID = Convert.ToInt32(item.StateID);
                    var State = db.States.Where(s => s.ID == StateID).Select(s => s.Name).FirstOrDefault();
                    <li>

                      <div class="contact-icon">
                        <i class="lni-phone-handset"></i>
                        <a> Phone:&nbsp;&nbsp; @item.PhoneNumber</a>
                      </div>

                      <div class="contact-icon" style="padding:0px;margin:0px">
                        <i class="lni-envelope"></i>
                        <a> Email:&nbsp;&nbsp; @item.Email</a>
                      </div>

                      <div class="contact-icon" style="padding:0px;margin:0px">
                        <i class="lni-map-marker"></i>
                        <a> Location:&nbsp;&nbsp; @item.Address @State</a>
                      </div>

                      <div class="contact-icon">
                        <i class="lni-link"></i>
                        <aa> Store URL:&nbsp;&nbsp;<span style="color:#0a92d7">  www.xamagos.com/@item.ShopURL</span></aa>
                      </div>

                    </li>
                  }
                }
              </ul>





              <h4 style="padding:0px">
                @*<i class="lni-briefcase"></i> @ViewBag.ShopName SHOP*@
                <!-- If it is your shop them this should display-->
                @if (!string.IsNullOrEmpty((string)Session["username"]) && ((string)Session["UserRole"] == "Shop Admin" || (string)Session["UserRole"] == "Super Admin") && (int)Session["UserID"] == (int)ViewBag.UserID)
                {
                  foreach (var item1 in ViewBag.Shop)
                  {
                    @*<a href="~/Products/Create/@item1.ID" class="btn btn-common" style="height:25px;padding:1px" title="Add Product"><i class="lni-plus"></i></a>*@

                    @*<span class="full-time" style="color:white; background-color:white;padding:0px;margin:0px;">
                          <a href="#" class="btn btn-primary" style="height:25px;padding:2px;width:40px;font-weight:bold;font-size:17px" title="Change Product Picture" data-toggle="modal" data-target="#myModal" onclick="clearTextBox();"> <i class="lni-camera"></i></a>
                      </span>*@
                  }
                }

              </h4>

              <ul class="list-item" style="font-size:10px;padding:0px;margin:0px">
                @if (ViewBag.ShopName != null)
                {
                  foreach (var item in ViewBag.Shop)
                  {

                    <li>
                      @*
                                                                         <div class="contact-icon">
                            <i class="lni-map-marker"></i>
                            <a> Location:  @item.CountryRegion.Country - @item.StateID</a>

                            |
                            <i class="lni-phone-handset"></i>
                            <a> Phone:&nbsp;&nbsp; @item.PhoneNumber</a>
                        </div>

                        <div class="contact-icon" style="padding:0px;margin:0px">
                            <i class="lni-envelope"></i>
                            <a> Email:&nbsp;&nbsp; @item.Email</a>
                        </div>*@
                      <div class="contact-icon">

                        <input id="address" type="hidden" value="@item.Address" />

                        <br />
                        <div id="map"></div>

                      </div>
                    </li>
                  }
                }
              </ul>

            </div>






          </div>
        </div>
        <!-- Categories Widget -->
        @*<div id="originalcategory" style="display:block">
              <div class="widget ">
                  <h5 class="widget-title" style="background-color:#0BACE1;color:white;padding:10px">Product Categories</h5>
                  <div class="widget-categories widget-box">
                      <ul class="cat-list">
                          @if (ViewBag.Products != null)
                          {
                              foreach (var item in ViewBag.Products)
                              {
                                  int ShopID = item.Shop.ID;
                                  int PCID = item.ProductCategoryID;
                                  int total = db.Products.Where(p => p.ProductCategoryID == PCID && p.ShopID == ShopID && p.ProductStatu.Status == "Available").Count();
                                  <li>
                                      <a href="~/Products/ProductCategoryDetails/?id=@item.ProductCategoryID&sid=@item.Shop.ID" style="color:#0BACE1;">
                                          @item.ProductCategory.Name
                                          <span class="num-posts">(@total)</span>
                                      </a>
                                  </li>
                              }
                          }
                      </ul>
                  </div>
              </div>
          </div>*@
        <div id="similarproducts">

          <!-- Popular Posts widget -->
          <div class="widget">
            <h5 class="widget-title" style="background-color:#0BACE1;color:white;padding:10px">Similar Products</h5>
            <div class="widget-popular-posts widget-box">
              @if (ViewBag.SimilarProducts != null)
              {
                <div class="row">
                  @foreach (var item in ViewBag.SimilarProducts)
                  {
                    <div class="col-12 col-md-6 col-lg-6">
                      <div class="widget-content">

                        <a href="~/Products/ProductDetails" class="nav-link" style="color:#0BACE1;" onclick="setObjectSession('ProductID',@item.ID)">
                          @item.Name
                        </a>
                      </div>
                    </div>

                  }
                </div>
              }
              @*<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
                                               <ins class="adsbygoogle"
                                                    style="display:block"
                                                    data-ad-format="fluid"
                                                    data-ad-layout-key="-fb+5w+4e-db+86"
                                                    data-ad-client="ca-pub-9669074385116966"
                                                    data-ad-slot="9054225413"></ins>
                                               <script>
                (adsbygoogle = window.adsbygoogle || []).push({});
                                               </script>*@
            </div>
          </div>
        </div>

        <div id="relatedproducts">

          <!-- Popular Posts widget -->
          <div class="widget">
            <h5 class="widget-title" style="background-color:#0BACE1;color:white;padding:10px">Related Products</h5>
            <div class="widget-popular-posts widget-box">

              @if (ViewBag.RelatedProducts != null)
              {
                <div class="row">
                  @foreach (var item in ViewBag.RelatedProducts)
                  {
                    <div class="col-12 col-md-6 col-lg-6">
                      <div class="widget-content">

                        <a href="~/Products/ProductDetails" class="nav-link" style="color:#0BACE1;" onclick="setObjectSession('ProductID',@item.ID)">
                          @item.Name
                        </a>
                      </div>
                    </div>

                  }
                </div>
              }

              @*<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
                                               <ins class="adsbygoogle"
                                                    style="display:block"
                                                    data-ad-format="fluid"
                                                    data-ad-layout-key="-fb+5w+4e-db+86"
                                                    data-ad-client="ca-pub-9669074385116966"
                                                    data-ad-slot="7002777145"></ins>
                                               <script>
                (adsbygoogle = window.adsbygoogle || []).push({});
                                               </script>

                                               <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
                                               <ins class="adsbygoogle"
                                                    style="display:block"
                                                    data-ad-format="fluid"
                                                    data-ad-layout-key="-fb+5w+4e-db+86"
                                                    data-ad-client="ca-pub-9669074385116966"
                                                    data-ad-slot="9054225413"></ins>
                                               <script>
                (adsbygoogle = window.adsbygoogle || []).push({});
                                               </script>*@
            </div>
          </div>
        </div>

        <!-- Tag Media -->
        <div class="widget">
          @*<h5 class="widget-title">Tags</h5>
            <div class="tag widget-box">
                <a href="#"> Jobpress</a>
                <a href="#"> Recruiter</a>
                <a href="#"> Interview</a>
                <a href="#"> Employee</a>
                <a href="#"> Labor</a>
                <a href="#"> HR</a>
                <a href="#"> Salary</a>
                <a href="#"> Employer</a>
            </div>*@
        </div>

        <!-- Archives Widget -->
        <div class="widget">
          @*<h5 class="widget-title">Archives</h5>
            <div class="widget-archives widget-box">
                <ul class="cat-list">
                    <li>
                        <a href="#">October 2016 <span class="num-posts">(29)</span></a>
                    </li>
                    <li>
                        <a href="#">September 2016 <span class="num-posts">(34)</span></a>
                    </li>
                    <li>
                        <a href="#">August 2016 <span class="num-posts">(23)</span></a>
                    </li>
                    <li>
                        <a href="#">July 2016 <span class="num-posts">(38)</span></a>
                    </li>
                    <li>
                        <a href="#">June 2016 <span class="num-posts">(16)</span></a>
                    </li>
                    <li>
                        <a href="#">May 2016 <span class="num-posts">(14)</span></a>
                    </li>
                    <li>
                        <a href="#">April 2016 <span class="num-posts">(17)</span></a>
                    </li>
                </ul>
            </div>*@
        </div>
      </aside>
      <!--End sidebar-->
    </div>
  </div>
  @*</div></div>
        </section>
    </div>*@
  <!-- End Content -->
  <script src="https://platform-api.sharethis.com/js/sharethis.js#property =5d59c459c60153001277bb6f&product =inline-share-buttons"></script>
</body>



<script type="text/javascript">
  function increament() {
    var currentval = parseInt(document.getElementById("quantity").value);
    currentval += 1;
    document.getElementById("quantity").value = currentval;
    //if (currentval > parseInt(document.getElementById("quantityinstock").value)) {
    //    alert("The quantity you are trying to order is more than quantity in stock!");
    //}
    //else
    //{
    //    document.getElementById("quantity").value = currentval;
    //}

  }
  function decreament() {
    var currentval = document.getElementById("quantity").value;
    if (currentval != 1) {
      document.getElementById("quantity").value = currentval - 1;
      var totalprice = currentval * parseInt(document.getElementById("amount").value)
      document.getElementById("amount").value = totalprice;
    }
  }

  function CheckFileName() {
    var fileName = document.getElementById("uploadFile").value
    //debugger;
    if (fileName == "") {
      alert("Browse to upload a valid File with jpg/jpeg/gif/png/ico");
      return false;
    }
    else if (fileName.split(".")[1].toUpperCase() == "JPG" || fileName.split(".")[1].toUpperCase() == "JPEG" || fileName.split(".")[1].toUpperCase() == "GIF" || fileName.split(".")[1].toUpperCase() == "PNG" || fileName.split(".")[1].toUpperCase() == "ICO")
      return true;
    else {
      alert("File with " + fileName.split(".")[1] + " is invalid. Upload a valid file with jpg/jpeg/gif/png/ico");
      return false;
    }
    return true;
  }
</script>
<script type="text/javascript">
  var maxSize = '15';
  function fileSizeValidate(fdata) {
    if (fdata.files && fdata.files[0]) {
      var fsize = fdata.files[0].size / 1024;
      if (fsize > maxSize) {
        alert('Maximum file size exceed! Image size should not be larger than 15KB');
        document.getElementById("uploadFile").value = null;
        return false;
      } else {
        return true;
      }
    }
  }
</script>

<script type="text/javascript">
  var minSize = '12';
  function fileSizeValidateMin(fdata) {
    if (fdata.files && fdata.files[0]) {
      var fsize = fdata.files[0].size / 1024;
      if (fsize < minSize) {
        alert('Minimum file size not reached! Image size should not be less than 12KB');
        document.getElementById("uploadFile").value = null;
        return false;
      } else {
        return true;
      }
    }
  }
</script>
<script type="text/javascript">
  function myFunction(x) {
    if (x.matches) { // If media query matches
      //document.getElementById("getcategorycontent").style.display = "block";
      //document.getElementById("getcategorycontent").innerHTML = document.getElementById("originalcategory").innerHTML;
      //document.getElementById("originalcategory").style.display = "none";

      document.getElementById("similarmobile").style.display = "block";
      document.getElementById("similarmobile").innerHTML = document.getElementById("similarproducts").innerHTML;
      document.getElementById("similarproducts").style.display = "none";

      document.getElementById("relatedmobile").style.display = "block";
      document.getElementById("relatedmobile").innerHTML = document.getElementById("relatedproducts").innerHTML;
      document.getElementById("relatedproducts").style.display = "none";


      document.getElementById("mobileproductdetails").style.display = "block";
      document.getElementById("mobileproductdetails").innerHTML = document.getElementById("originalproductdetails").innerHTML;
      document.getElementById("originalproductdetails").style.display = "none";

    } else {
      // document.getElementById("originalcategory").style.display = "block";
      // document.getElementById("getcategorycontent").style.display = "none";
      document.getElementById("similarproducts").style.display = "block";
      document.getElementById("similarmobile").style.display = "none";

      document.getElementById("relatedproducts").style.display = "block";
      document.getElementById("relatedmobile").style.display = "none";

      document.getElementById("originalproductdetails").style.display = "block";
      document.getElementById("mobileproductdetails").style.display = "none";
    }
  }

  var x = window.matchMedia("(max-width: 600px)")
  myFunction(x) // Call listener function at run time
  x.addListener(myFunction) // Attach listener function on state changes
</script>

<script type="text/javascript">
  function GetCities(StateID) {

    var url = "/Products/GetCities/";
    $.ajax({
      url: url,
      data: { StateID: StateID },
      cache: false,
      type: "GET",
      success: function (data) {
        var html = '';
        html += '<span style="font-weight:bold;margin-top:5px;color:black">Please Select<select id="city" name="cityid" class="form-control" style ="height:36px;padding-top:3px;margin-bottom:2px;" onchange="GetDelivieryInfo()" required="required" placeholder="-- Please select --">';
        html += '<option selected></option>';
        $.each(data, function (key, item) {

          html += '<option value="' + item.ID + '">' + item.CityName + '</option>';
        });
        html += '</select></span>';
        $("#displaycities").html(html).show();
      },
      error: function (reponse) {
        alert("error : " + reponse);
      }
    });
  }
</script>

@*<script type="text/javascript">
          function GetDelivieryInfo() {
              var _StateID = document.getElementById("StateID").value;
              var _city = document.getElementById("city").value;

              var _FromStateID = document.getElementById("FromStateID").value;
              var url = "/Products/GetDeliveryInfo/";
              $.ajax({
                  url: url,
                  data: { StateID:_StateID,city:_city,FromStateID:_FromStateID },
                  cache: false,
                  type: "GET",
                  success: function (data) {

                      $.each(data, function (key, item) {
                          var ship = '+ shipping  â‚¦' + formatNumber(item.shippingcost) + ' from ' + item.FromLocation + ' to ' + item.Location;
                          $("#shipping").html(ship).show();
                          $("#DeliveryCity_ID").val(item.ID);
                          $("#deliverynote").html(item.deliverynote +"<hr>").show();
                      });

                  },
                  error: function (reponse) {
                      alert("error : " + reponse);
                  }
              });
          }
  </script>*@

<script type="text/javascript">
  function GetDelivieryInfo() {
    document.getElementById("dcity").value = document.getElementById("city").value;
  }
</script>


<script type="text/javascript">
  function formatNumber(num) {
    return num.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g, '$1,')
  }
</script>
